{% extends "base.html" %}

{% block title %}{{ _('Model Overview') }}{% endblock %}

{% block content %}
<div class="container">
  <h1 class="mb-4 text-primary">{{ _('Model Overview') }}</h1>

  <!-- ðŸ”„ Model Workflow -->
  <section class="mb-5">
    <h4 class="mb-3">{{ _('Workflow Diagram') }}</h4>
    <div class="row text-center">
      <div class="col">
        <i class="bi bi-image" style="font-size: 2rem;"></i>
        <p>{{ _('Image') }}</p>
      </div>
      <div class="col">
        <i class="bi bi-box" style="font-size: 2rem;"></i>
        <p>{{ _('ViT') }}</p>
      </div>
      <div class="col">
        <i class="bi bi-cpu" style="font-size: 2rem;"></i>
        <p>{{ _('BLIP-Base') }}</p>
      </div>
      <div class="col">
        <i class="bi bi-chat-left-text" style="font-size: 2rem;"></i>
        <p>{{ _('English Caption') }}</p>
      </div>
    </div>
  </section>

  <!-- ðŸ“‹ Model Details Table -->
  <section class="mb-5">
    <div class="card shadow-sm">
      <div class="card-body">
        <h5 class="card-title text-primary">{{ _('Model Details') }}</h5>
        <div class="table-responsive">
          <table class="table table-bordered text-center align-middle">
            <thead class="table-light">
              <tr>
                <th><i class="bi bi-tag"></i> {{ _('Name') }}</th>
                <th><i class="bi bi-diagram-3"></i> {{ _('Architecture') }}</th>
                <th><i class="bi bi-box-arrow-in-down"></i> {{ _('Input') }}</th>
                <th><i class="bi bi-box-arrow-up"></i> {{ _('Output') }}</th>
                <th><i class="bi bi-exclamation-circle"></i> {{ _('Limitations') }}</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>{{ _('blip-image-captioning-base') }}</td>
                <td>{{ _('ViT + BLIP-Base') }}</td>
                <td>{{ _('Image') }}</td>
                <td>{{ _('English Caption') }}</td>
                <td>{{ _('Does not understand cultural context, produces generic descriptions') }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </section>

  <!-- ðŸ“Š Caption Length Chart -->
  <section class="mb-5">
    <div class="card shadow-sm">
      <div class="card-body">
        <h5 class="card-title text-primary">{{ _('Caption Length Comparison') }}</h5>
        <canvas id="captionChart" style="max-height: 300px;"></canvas>
      </div>
    </div>
  </section>

  <!-- ðŸ© Caption Quality Chart -->
  <section class="mb-5">
    <div class="card shadow-sm">
      <div class="card-body">
        <h5 class="card-title text-primary">{{ _('Caption Quality Analysis') }}</h5>
        <canvas id="qualityChart" style="max-height: 300px;"></canvas>
      </div>
    </div>
  </section>

  <!-- ðŸ–¼ï¸ Image Type Chart -->
  <section class="mb-5">
    <div class="card shadow-sm">
      <div class="card-body">
        <h5 class="card-title text-primary">{{ _('Image Type Distribution') }}</h5>
        <canvas id="imageTypeChart" style="max-height: 300px;"></canvas>
      </div>
    </div>
  </section>

  <!-- ðŸ” Advanced Dashboard Button -->
  <div class="text-center mt-4">
    <a href="{{ url_for('dashboard_bp.advanced_dashboard') }}" 
       class="btn btn-gradient shadow-lg" 
       style="padding: 12px 24px; border-radius: 8px; display: inline-flex; align-items: center; gap: 10px;">
       
       <img src="{{ url_for('static', filename='images/logo.png') }}" 
            alt="Site Logo" style="height:40px;">
       
       <span style="font-size: 18px;">Advanced Dashboard</span>
    </a>
  </div>
</div>




<!-- Pass dynamic data from Flask to JavaScript -->
<script>
  async function loadModelData() {
    const response = await fetch("/model-data?" + Date.now()); // ÙƒØ³Ø± Ø§Ù„ÙƒØ§Ø´
    const data = await response.json();
    renderCaptionChart(data.image_labels, data.caption_lengths);
    renderQualityChart(data.quality_counts);
    renderImageTypeChart(data.type_counts);
  }

  loadModelData();

  const channel = new BroadcastChannel("modelChannel");
  channel.onmessage = (event) => {
    if (event.data.action === "updateModel") {
      loadModelData();
    }
  };
</script>










<script src="{{ url_for('static', filename='charts_model.js') }}"></script>


<!-- CSS for Button Effect -->
<style>
.btn-gradient {
  background: linear-gradient(45deg, #f9a825, #ff6f00, #2196f3, #43a047);
  color: white;
  border: none;
  transition: transform 0.2s ease-in-out;
  background-size: 300% 300%;
  animation: gradientShift 6s ease infinite;
}
.btn-gradient:hover {
  transform: scale(1.05);
}
@keyframes gradientShift {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}
</style>
{% endblock %}
